# reCAPTCHA Setup Guide

## –û–ø–∏—Å–∞–Ω–∏–µ

–í –ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ **Google reCAPTCHA v2**. reCAPTCHA –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ö –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ø–∞–º–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π.

## –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã

‚úÖ **–§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** (`/register`) - –∑–∞—â–∏—Ç–∞ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –±–æ—Ç–æ–≤
‚úÖ **–§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è** (`/create-event`) - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º-—Å–æ–±—ã—Ç–∏–π

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π Google reCAPTCHA

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google reCAPTCHA Admin Console](https://www.google.com/recaptcha/admin/create)
2. –í–æ–π–¥–∏—Ç–µ —Å –≤–∞—à–∏–º Google –∞–∫–∫–∞—É–Ω—Ç–æ–º
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∞–π—Ç–∞:
   - **Label (–ú–µ—Ç–∫–∞)**: ObschiySbor (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
   - **reCAPTCHA type**: reCAPTCHA v2 ‚Üí "I'm not a robot" Checkbox
   - **Domains (–î–æ–º–µ–Ω—ã)**:
     - –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `localhost`
     - –î–ª—è production: –≤–∞—à –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `obschiy-sbor.vercel.app`)
   - **Accept the reCAPTCHA Terms of Service**: –æ—Ç–º–µ—Ç—å—Ç–µ –≥–∞–ª–æ—á–∫—É
4. –ù–∞–∂–º–∏—Ç–µ **Submit**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏:
   - **Site Key** - –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á)
   - **Secret Key** - –¥–ª—è –±—ç–∫–µ–Ω–¥–∞ (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–î–æ–±–∞–≤—å—Ç–µ **Site Key** –≤ —Ñ–∞–π–ª `frontend/.env`:

```env
VITE_RECAPTCHA_SITE_KEY=your_site_key_here
```

**–í–∞–∂–Ω–æ**:
- –§–∞–π–ª `.env` –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ git (–æ–Ω –≤ `.gitignore`)
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env` –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä (`npm run dev`)

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä:
   ```bash
   cd frontend
   npm run dev
   ```

2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: http://localhost:5173/register
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤–∏–¥–∂–µ—Ç reCAPTCHA —Å —á–µ–∫–±–æ–∫—Å–æ–º "I'm not a robot"
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è:
   - **–ë–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–∞–ª–æ—á–∫–∏** ‚Üí –ø–æ—è–≤–∏—Ç—Å—è –æ—à–∏–±–∫–∞ "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –Ω–µ —Ä–æ–±–æ—Ç"
   - **–° —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≥–∞–ª–æ—á–∫–∏** ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö

### Development Mode (–±–µ–∑ –∫–ª—é—á–∞)
–ï—Å–ª–∏ `VITE_RECAPTCHA_SITE_KEY` –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
- reCAPTCHA **–Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∂—ë–ª—Ç–∞—è –ø–ª–∞—à–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ –≤–∏–¥–∂–µ—Ç–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π
- –§–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç **–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏** (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### Development Mode (—Å –∫–ª—é—á–æ–º)
–ï—Å–ª–∏ `VITE_RECAPTCHA_SITE_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
- reCAPTCHA –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ - —Ñ–æ—Ä–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

### Production Mode
–í production **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ reCAPTCHA:
- –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Vercel (Settings ‚Üí Environment Variables)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ production –¥–æ–º–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Google reCAPTCHA

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**`RecaptchaWrapper`** (`frontend/src/components/RecaptchaWrapper.jsx`)
- –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `react-google-recaptcha`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `forwardRef` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ—Ç–æ–¥–∞–º —á–µ—Ä–µ–∑ ref
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç dev-friendly –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–ª—é—á–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```jsx
import { useRef, useState } from 'react';
import RecaptchaWrapper from '../components/RecaptchaWrapper';

const MyForm = () => {
  const [recaptchaToken, setRecaptchaToken] = useState(null);
  const recaptchaRef = useRef(null);

  const handleSubmit = async (e) => {
    e.preventDefault();

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
    const recaptchaSiteKey = import.meta.env.VITE_RECAPTCHA_SITE_KEY;
    if (recaptchaSiteKey && !recaptchaToken) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –Ω–µ —Ä–æ–±–æ—Ç');
      return;
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã...

    // –°–±—Ä–æ—Å –ø—Ä–∏ –æ—à–∏–±–∫–µ
    if (error && recaptchaRef.current) {
      recaptchaRef.current.reset();
      setRecaptchaToken(null);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      {/* –í–∞—à–∏ –ø–æ–ª—è */}

      <RecaptchaWrapper
        ref={recaptchaRef}
        onChange={(token) => setRecaptchaToken(token)}
        onExpired={() => setRecaptchaToken(null)}
      />

      <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
  );
};
```

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **`react-google-recaptcha`** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è React –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è Google reCAPTCHA

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:

üî≤ **Backend –≤–∞–ª–∏–¥–∞—Ü–∏—è** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Å—Ä–µ–¥–Ω–∏–π)
- –î–æ–±–∞–≤–∏—Ç—å Edge Function –≤ Supabase –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Secret Key` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google API
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –æ–±—Ö–æ–¥ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

üî≤ **Rate Limiting** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –≤—ã—Å–æ–∫–∏–π)
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/—Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π —Å –æ–¥–Ω–æ–≥–æ IP
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

üî≤ **Invisible reCAPTCHA** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –Ω–∏–∑–∫–∏–π)
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ invisible reCAPTCHA –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

## Troubleshooting

### reCAPTCHA –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `VITE_RECAPTCHA_SITE_KEY` –≤ `.env`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –û—à–∏–±–∫–∞ "Invalid site key"
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Site Key —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ–º–µ–Ω `localhost` –¥–æ–±–∞–≤–ª–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Google reCAPTCHA
3. –î–ª—è production –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à –¥–æ–º–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö

### reCAPTCHA –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `useRef` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–∑–æ–≤ `recaptchaRef.current.reset()` –≤ –±–ª–æ–∫–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç–µ `recaptchaToken` —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `setRecaptchaToken(null)`

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Google reCAPTCHA Admin Console](https://www.google.com/recaptcha/admin)
- [reCAPTCHA v2 Documentation](https://developers.google.com/recaptcha/docs/display)
- [react-google-recaptcha GitHub](https://github.com/dozoisch/react-google-recaptcha)

## –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `react-google-recaptcha`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `RecaptchaWrapper`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (`Register.jsx`)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è (`CreateEvent.jsx`)
- ‚úÖ Graceful degradation (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ dev —Ä–µ–∂–∏–º–µ)
- ‚è≥ Backend –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Edge Functions (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- ‚è≥ Rate limiting –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
